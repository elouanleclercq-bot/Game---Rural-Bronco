<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Rural Bronco: The Gay — Playable Demo</title>
<style>
  :root{
    --bg:#0f172a; --panel:#0b1220; --accent:#f5a524; --text:#e6eef8;
    --tile:#1b2433; --player:#ffb86b; --enemy:#ff6b6b; --heart:#ff6ea1;
  }
  html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;}
  body{background:linear-gradient(180deg,#071124 0%, #0b1730 100%); color:var(--text); display:flex; align-items:flex-start; justify-content:center; padding:18px;}
  .game { width:1000px; max-width:100%; display:grid; grid-template-columns: 520px 1fr; gap:18px; }
  .panel { background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border-radius:12px; padding:12px; box-shadow: 0 8px 24px rgba(2,6,23,0.6);}
  .left{min-height:640px}
  .map-wrap { background:var(--panel); border-radius:8px; padding:10px; display:flex; gap:10px; align-items:flex-start; }
  .map { width:320px; height:320px; background:linear-gradient(180deg,#182233,#0f1a2b); border-radius:6px; padding:6px; display:grid; grid-template-columns: repeat(10,1fr); grid-auto-rows: 32px; gap:2px; }
  .cell { background:var(--tile); border-radius:4px; display:flex; align-items:center; justify-content:center; font-size:12px; color:#b9c5d8; }
  .cell.player {background: none; box-shadow: none;}
  .cell.enemy{background:linear-gradient(180deg,var(--enemy),#ff8b6b); box-shadow:0 0 8px rgba(255,107,107,0.25);}
  .hud { margin-top:10px; display:flex; gap:8px; flex-wrap:wrap; }
  .card { background:rgba(0,0,0,0.25); padding:8px 10px; border-radius:8px; min-width:120px; }
  .right{min-height:640px}
  .log { height:260px; background:#071026; padding:8px; border-radius:8px; overflow:auto; font-size:13px; color:#dce9ff; }
  .controls{ display:flex; gap:6px; margin-top:8px; }
  button{background:var(--accent); color:#02111b; border:none; padding:8px 10px; border-radius:8px; font-weight:700; cursor:pointer}
  button.secondary{background:#2f4258; color:var(--text); font-weight:600}
  .battle-ui{ background:linear-gradient(180deg,#081325,#052033); padding:12px; border-radius:8px; margin-top:12px;}
  .row{display:flex; gap:8px; align-items:center;}
  .stat{font-weight:700}
  .inv{display:flex; gap:8px; flex-wrap:wrap; margin-top:8px}
  .small{padding:6px 8px;font-size:13px}
  .map-title{font-size:14px; font-weight:800; margin-bottom:6px}
  .footer{font-size:12px;color:#98a3b8;margin-top:8px}
  .big-btn{padding:10px 14px; font-size:15px}
  input.cmd{background:#071026;border:1px solid #123046;color:var(--text);padding:8px;border-radius:6px;flex:1}
  .center{display:flex;align-items:center;justify-content:center}
</style>
</head>
<body>
  <div class="game">
    <div class="panel left">
      <div style="display:flex;justify-content:space-between;align-items:center;">
        <div>
          <h2 style="margin:0;">Rural Bronco: The Gay</h2>
          <div style="font-size:12px;color:#9fb2d6">Top-down / Pokémon-style combat — Absurd comedy</div>
        </div>
        <div style="text-align:right">
          <div style="font-size:12px;color:#9fb2d6">Home: Residium</div>
          <div style="font-weight:800;color:var(--accent)">Coins: <span id="coins">0</span></div>
        </div>
      </div>

      <div class="map-wrap" style="margin-top:12px;">
        <div style="width:100%;display:flex;flex-direction:column;">
          <div class="map-title">French rural street (10×10)</div>
          <div id="map" class="map"></div>
          <div class="hud">
            <div class="card">HP: <span id="hp">3</span>/<span id="maxhp">3</span></div>
            <div class="card">Hearts: <span id="hearts">0</span></div>
            <div class="card">Attacks: <span id="attacks-list">Chokiccinos</span></div>
            <div class="card">Location: <span id="loc-name">French rural street</span></div>
          </div>

          <div style="margin-top:10px;">
            <div class="footer">Move with arrow keys / WASD. Each step may trigger encounters. Type commands below for actions.</div>
          </div>

        </div>
      </div>

      <div style="margin-top:12px; display:flex; gap:8px;">
        <button id="btn-resid" class="secondary">Go to Residium (Home)</button>
        <button id="btn-loreal">Go to L'Oréal HQ</button>
        <button id="btn-lilas">Go to Les Lilas</button>
        <button id="save-btn" class="secondary">Save</button>
        <button id="load-btn" class="secondary">Load</button>
      </div>

      <div style="margin-top:12px;">
        <div class="log" id="log"></div>
        <div style="display:flex;margin-top:8px;gap:8px;">
          <input id="cmd" class="cmd" placeholder="Type: attack demon voice | run | collect heart | status" />
          <button id="enter" class="big-btn">Do</button>
        </div>
      </div>

    </div>

    <div class="panel right">
      <h3 style="margin:0 0 6px 0">Battle / UI</h3>

      <div id="battle-area" class="battle-ui">
        <div id="battle-state" class="center" style="min-height:120px;">Explore the map — enter fights to see combat UI.</div>
      </div>

      <div style="margin-top:12px;">
        <div style="display:flex;gap:8px;align-items:center;">
          <div class="card">Player Level: <span id="level">1</span></div>
          <div class="card">XP: <span id="xp">0</span></div>
          <div class="card">Steps: <span id="steps">0</span></div>
        </div>

        <div style="margin-top:10px;">
          <div style="font-weight:700;margin-bottom:6px">Inventory</div>
          <div class="inv" id="inventory"></div>
        </div>

      </div>

      <div style="margin-top:16px;">
        <div style="font-size:13px;color:#9fb2d6">Credits / Notes</div>
        <div style="font-size:12px;color:#9fb2d6;margin-top:6px">
          Placeholder visuals used for immediate play. I can swap in hotlinked PNG sprites from Kenney / OpenGameArt on request.  
          Asset references (for later swaps): Kenney top-down packs; OpenGameArt character/alien packs; itch.io free sprites. :contentReference[oaicite:1]{index=1}
        </div>
      </div>

    </div>
  </div>

<script>
/*
  SIMPLE PLAYABLE DEMO
  - Grid map (10x10)
  - Movement with keys, random encounters every 6-10 steps
  - Pokemon-style turn-based fights
  - Hearts increase max HP by +2 each
  - Unlocks: Demon Voice (after rural), Choky Constitution (after L'Oréal), Flex Pitch (after Les Lilas), Fred Again magic (pre-final)
  - Enemies: varied per area; bosses: Big H, Alien, BillyBob (final)
  - Save/load (in-memory using localStorage)
*/

/* --- Game data --- */
const maps = {
  "French rural street": {w:10,h:10, enemyPool:["Village Punk","Drunken Goat","Roadside Huckster"], stepsRange:[6,10]},
  "L'Oréal HQ": {w:8,h:8, enemyPool:["Facial Exec","Perfume Drone","Security Bot"], stepsRange:[5,9]},
  "Les Lilas": {w:12,h:12, enemyPool:["Lilac Thug","Busker","Fashion Goon"], stepsRange:[4,8]},
  "Residium": {w:6,h:6, enemyPool:[], stepsRange:[999,999]}
};

let state = {
  location: "French rural street",
  x: 4, y: 4,
  hp: 3, maxhp: 3,
  hearts: 0,
  coins: 0,
  steps: 0,
  level: 1, xp: 0,
  attacks: ["Chokiccinos"], // unlock path later
  inventory: [],
  inBattle: false,
  currentEnemy: null,
  saveKey: "rural-bronco-save-v1"
};

/* --- Enemy templates --- */
const enemyTemplates = {
  "Village Punk": {hp:4,attacks:[{name:"Deflated Bed",dmg:1},{name:"Vodka Cocktails",dmg:2}]},
  "Drunken Goat": {hp:3,attacks:[{name:"La Gare le Gore",dmg:1},{name:"Vodka Cocktails",dmg:2}]},
  "Roadside Huckster": {hp:5,attacks:[{name:"Deflated Bed",dmg:2},{name:"La Gare le Gore",dmg:1}]},
  "Facial Exec": {hp:6,attacks:[{name:"Deflated Bed",dmg:2},{name:"Vodka Cocktails",dmg:2}]},
  "Perfume Drone": {hp:5,attacks:[{name:"La Gare le Gore",dmg:2},{name:"Vodka Cocktails",dmg:1}]},
  "Security Bot": {hp:7,attacks:[{name:"Deflated Bed",dmg:2},{name:"La Gare le Gore",dmg:2}]},
  "Lilac Thug": {hp:6,attacks:[{name:"Deflated Bed",dmg:2},{name:"Vodka Cocktails",dmg:2}]},
  "Busker": {hp:4,attacks:[{name:"La Gare le Gore",dmg:1},{name:"Vodka Cocktails",dmg:1}]},
  "Fashion Goon": {hp:8,attacks:[{name:"Deflated Bed",dmg:3},{name:"La Gare le Gore",dmg:2}]},
  // bosses
  "Big H": {hp:18,attacks:[{name:"Rice Bowls",dmg:3},{name:"Economy",dmg:4},{name:"Autism",dmg:2}]},
  "Alien": {hp:20,attacks:[{name:"Big Tail",dmg:4},{name:"Smelly Smelly",dmg:3},{name:"No More Locker",dmg:4}]},
  "BillyBob The Bob": {hp:30,attacks:[{name:"Peg",dmg:4},{name:"Cuck Attack",dmg:6},{name:"Guinness Power Up",dmg:0, effect:"buff"}]}
};

/* --- Utility & UI --- */
const mapEl = document.getElementById("map");
const logEl = document.getElementById("log");
const hpEl = document.getElementById("hp");
const maxhpEl = document.getElementById("maxhp");
const heartsEl = document.getElementById("hearts");
const coinsEl = document.getElementById("coins");
const attacksListEl = document.getElementById("attacks-list");
const locNameEl = document.getElementById("loc-name");
const stepsEl = document.getElementById("steps");
const levelEl = document.getElementById("level");
const xpEl = document.getElementById("xp");
const invEl = document.getElementById("inventory");
const battleArea = document.getElementById("battle-area");
const attacksOrder = ["Chokiccinos","Demon Voice","Choky Constitution","Flex Pitch","Fred Again magic"];

function log(...txt){
  const line = document.createElement("div");
  line.textContent = txt.join(" ");
  logEl.appendChild(line);
  logEl.scrollTop = logEl.scrollHeight;
}

function renderMap(){
  const mapInfo = maps[state.location];
  mapEl.style.gridTemplateColumns = `repeat(${mapInfo.w}, 1fr)`;
  mapEl.innerHTML = "";
  for(let i=0;i<mapInfo.h;i++){
    for(let j=0;j<mapInfo.w;j++){
      const cell = document.createElement("div");
      cell.className = "cell";
      if(j === state.x && i === state.y) {
        cell.classList.add("player");
        const img = document.createElement("img");
        img.src = "images/Protagonist.png"; // must be in same folder or adjust path
        img.alt = "Player";
        img.style.width = "100%";
        img.style.height = "100%";
        img.style.objectFit = "contain";
        cell.appendChild(img);
      }
      mapEl.appendChild(cell);
    }
  }
  locNameEl.textContent = state.location;
  hpEl.textContent = state.hp;
  maxhpEl.textContent = state.maxhp;
  heartsEl.textContent = state.hearts;
  coinsEl.textContent = state.coins;
  attacksListEl.textContent = state.attacks.join(", ");
  stepsEl.textContent = state.steps;
  levelEl.textContent = state.level;
  xpEl.textContent = state.xp;
  invEl.innerHTML = state.inventory.map(i => `<div class="card small">${i}</div>`).join("");
}

/* --- Movement & encounters --- */
function move(dx,dy){
  if(state.inBattle) { log("Cannot move while in battle."); return; }
  const mapInfo = maps[state.location];
  const nx = Math.max(0, Math.min(mapInfo.w-1, state.x+dx));
  const ny = Math.max(0, Math.min(mapInfo.h-1, state.y+dy));
  if(nx===state.x && ny===state.y) return;
  state.x=nx; state.y=ny; state.steps++; stepsEl.textContent = state.steps;
  renderMap();
  checkEncounter();
}

function randInt(a,b){ return Math.floor(Math.random()*(b-a+1))+a; }

function checkEncounter(){
  const mapInfo = maps[state.location];
  const [mn,mx] = mapInfo.stepsRange;
  const chance = 1 / randInt(mn,mx); // approximate
  if(Math.random() < chance && mapInfo.enemyPool.length>0){
    const pool = mapInfo.enemyPool;
    const enemyName = pool[randInt(0,pool.length-1)];
    startBattle(enemyName);
  } else {
    // small chance to find a heart (rare)
    if(Math.random() < 0.02){
      collectHeart();
    }
  }
}

/* --- Hearts & progression --- */
function collectHeart(){
  state.hearts++;
  state.maxhp +=2;
  state.hp = Math.min(state.maxhp, state.hp+2);
  log("You found a heart! Max HP +2. Hearts:", state.hearts);
  renderMap();
}

/* --- Battle System --- */
function startBattle(enemyName, isBoss=false){
  state.inBattle = true;
  const tpl = enemyTemplates[enemyName];
  if(!tpl){
    log("Unknown enemy:",enemyName); state.inBattle=false; return;
  }
  state.currentEnemy = {name:enemyName, hp: tpl.hp, template: tpl, isBoss: isBoss||false};
  renderBattle();
  log("A wild", enemyName, "appears!");
}

function renderBattle(){
  battleArea.innerHTML = "";
  if(!state.inBattle){ battleArea.textContent = "Explore the map — enter fights to see combat UI."; return; }
  const enemy = state.currentEnemy;
  const enemyBox = document.createElement("div");
  enemyBox.style.flex="1";
  enemyBox.innerHTML = <div style="font-weight:800">${enemy.name}</div>
    <div>HP: <span id="e-hp">${enemy.hp}</span></div>;
  const playerBox = document.createElement("div");
  playerBox.style.flex="1";
  playerBox.innerHTML = <div style="font-weight:800">Rural Bronco</div>
    <div>HP: <span id="p-hp">${state.hp}</span>/<span id="p-max">${state.maxhp}</span></div>
    <div>Hearts: ${state.hearts}</div>;
  const actions = document.createElement("div");
  actions.style.display="flex"; actions.style.flexDirection="column"; actions.style.gap="8px";
  const attackList = document.createElement("div");
  attackList.style.display="flex"; attackList.style.flexWrap="wrap"; attackList.style.gap="8px";
  state.attacks.forEach(atk=>{
    const b = document.createElement("button");
    b.className="small";
    b.textContent = atk;
    b.onclick = ()=>playerAttack(atk);
    attackList.appendChild(b);
  });
  const runBtn = document.createElement("button");
  runBtn.className="secondary small";
  runBtn.textContent="Run";
  runBtn.onclick = tryRun;
  actions.appendChild(attackList);
  actions.appendChild(runBtn);

  const topRow = document.createElement("div"); topRow.className="row";
  topRow.appendChild(enemyBox); topRow.appendChild(playerBox);
  battleArea.appendChild(topRow);
  battleArea.appendChild(actions);
}

function dmgForAttack(name){
  // base damages for player's attacks; scale with hearts / xp
  const base = {
    "Chokiccinos": 2,
    "Demon Voice": 4,
    "Choky Constitution": 5,
    "Flex Pitch": 6,
    "Fred Again magic": 9
  }[name] || 2;
  // slight miss chance for stronger attacks
  const missChance = (name==="Flex Pitch"||name==="Fred Again magic")?0.15:0.08;
  if(Math.random() < missChance){ return {miss:true, dmg:0}; }
  // scale with hearts
  const dmg = base + Math.floor(state.hearts/1);
  return {miss:false, dmg};
}

function playerAttack(atkName){
  if(!state.inBattle) return;
  const res = dmgForAttack(atkName);
  if(res.miss){ log(atkName,"missed!"); enemyTurn(); renderBattle(); return; }
  state.currentEnemy.hp -= res.dmg;
  log("You used",atkName,"and dealt",res.dmg,"damage!");
  if(state.currentEnemy.hp<=0){
    winBattle();
  } else {
    renderBattle(); enemyTurn();
  }
}

function enemyTurn(){
  const enemy = state.currentEnemy;
  if(!enemy) return;
  // pick attack
  const pool = enemy.template.attacks;
  const atk = pool[randInt(0,pool.length-1)];
  // enemy deals damage to player
  const dmg = atk.dmg;
  state.hp -= dmg;
  log(enemy.name,"used",atk.name,"and did",dmg,"damage!");
  if(state.hp<=0){
    loseBattle();
  } else {
    renderBattle();
  }
}

function winBattle(){
  const enemy = state.currentEnemy;
  const coinsGain = randInt(2,6);
  state.coins += coinsGain;
  state.xp += 5;
  // small chance for heart drop
  if(Math.random() < 0.2) {
    collectHeart();
  }
  log("You defeated", enemy.name, "and gained", coinsGain, "coins and 5 XP.");
  // unlock logic: if this was a special area boss, unlock new attack
  maybeUnlockOnWin(enemy.name);
  state.inBattle=false;
  state.currentEnemy=null;
  renderBattle();
  renderMap();
  saveAuto();
}

function loseBattle(){
  log("You were defeated... Respawning at Residium with -10 coins penalty.");
  state.coins = Math.max(0, state.coins - 10);
  // respawn at Residium
  goTo("Residium");
  state.hp = Math.max(1, Math.floor(state.maxhp/2));
  state.inBattle=false;
  state.currentEnemy=null;
  renderBattle();
  renderMap();
  saveAuto();
}

function tryRun(){
  if(Math.random() < 0.7){ log("You ran away!"); state.inBattle=false; state.currentEnemy=null; renderBattle(); renderMap(); }
  else { log("Failed to run!"); enemyTurn(); }
}

/* --- Unlocks --- */
function maybeUnlockOnWin(enemyName){
  // simplistic: first time you kill any enemy in a new location unlocks its attack
  const loc = state.location;
  if(loc==="French rural street" && !state.attacks.includes("Demon Voice")) {
    state.attacks.push("Demon Voice"); log("You learned Demon Voice!");
  }
  if(loc==="L'Oréal HQ" && !state.attacks.includes("Choky Constitution")) {
    state.attacks.push("Choky Constitution"); log("You learned Choky Constitution!");
  }
  if(loc==="Les Lilas" && !state.attacks.includes("Flex Pitch")) {
    state.attacks.push("Flex Pitch"); log("You learned Flex Pitch!");
  }
  // final unlock if you have 5 hearts
  if(state.hearts>=5 && !state.attacks.includes("Fred Again magic")){
    state.attacks.push("Fred Again magic"); log("You unlocked Fred Again magic!");
  }
}

/* --- Map teleport / hubs --- */
function goTo(name){
  if(!maps[name]) return;
  state.location = name;
  // place at center of map
  const m = maps[name];
  state.x = Math.floor(m.w/2); state.y = Math.floor(m.h/2);
  state.steps = 0;
  log("Travelling to",name);
  renderMap();
}

/* --- Save / Load --- */
function saveAuto(){
  localStorage.setItem(state.saveKey, JSON.stringify(state));
  log("Auto-saved.");
}
function saveManual(){
  localStorage.setItem(state.saveKey, JSON.stringify(state));
  log("Saved.");
}
function loadManual(){
  const s = localStorage.getItem(state.saveKey);
  if(!s) { log("No saved game found."); return; }
  const obj = JSON.parse(s);
  Object.assign(state,obj);
  log("Loaded saved game.");
  renderMap(); renderBattle();
}

/* --- Keyboard & UI wiring --- */
document.addEventListener("keydown", e=>{
  if(state.inBattle) return;
  if(e.key==="ArrowUp"||e.key==="w") move(0,-1);
  if(e.key==="ArrowDown"||e.key==="s") move(0,1);
  if(e.key==="ArrowLeft"||e.key==="a") move(-1,0);
  if(e.key==="ArrowRight"||e.key==="d") move(1,0);
});

document.getElementById("btn-resid").onclick = ()=>goTo("Residium");
document.getElementById("btn-loreal").onclick = ()=>goTo("L'Oréal HQ");
document.getElementById("btn-lilas").onclick = ()=>goTo("Les Lilas");
document.getElementById("save-btn").onclick = ()=>saveManual();
document.getElementById("load-btn").onclick = ()=>loadManual();
document.getElementById("enter").onclick = handleCmd;
document.getElementById("cmd").addEventListener("keydown", e=>{ if(e.key==="Enter") handleCmd(); });

function handleCmd(){
  const v = document.getElementById("cmd").value.trim();
  if(!v) return;
  document.getElementById("cmd").value="";
  const parts = v.split(" ");
  const cmd = parts[0].toLowerCase();
  if(cmd==="attack"){
    const atk = parts.slice(1).join(" ");
    if(!atk){ log("Specify attack name exactly (e.g., attack Chokiccinos)"); return; }
    if(!state.attacks.includes(atk)){ log("You don't know that attack."); return; }
    if(!state.inBattle){ log("You're not in a battle."); return; }
    playerAttack(atk);
    return;
  }
  if(cmd==="run"){ tryRun(); return; }
  if(cmd==="collect" && parts[1]=="heart"){ collectHeart(); return; }
  if(cmd==="status"){ log("HP:",state.hp,"/",state.maxhp,"Hearts:",state.hearts,"Coins:",state.coins,"Attacks:",state.attacks.join(",")); return; }
  if(cmd==="spawn"){
    // spawn a named enemy for testing
    const name = parts.slice(1).join(" ");
    if(name && enemyTemplates[name]) startBattle(name);
    else log("Unknown spawn target. Example: spawn Big H");
    return;
  }
  log("Unknown command:", v);
}

/* --- Create initial map --- */
function init(){
  // ensure Residium exists
  maps["Residium"] = {w:6,h:6, enemyPool:[], stepsRange:[999,999]};
  goTo(state.location);
  renderMap();
  renderBattle();
  log("Game ready. Travel the world, collect hearts, learn attacks, and face BillyBob The Bob when you're strong.");
  // allow player to trigger final boss if they want (cheat)
  log("Tip: use command 'spawn BillyBob The Bob' to fight final boss (or earn hearts and go normally).");
}
init();
</script>
</body>
</html>
